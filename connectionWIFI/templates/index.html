<!DOCTYPE html>
<html>
	<head>
		<title>connexion au wifi du Photobooth</title>
	    <meta charset="UTF-8">
	    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	    <!-- Bootstrap CSS -->
	    <link rel="stylesheet" href="{{ url_for('static', filename='bootstrap/css/bootstrap.min.css') }}">
		<!-- Font Awesome -->
		<link rel="stylesheet" href="{{ url_for('static', filename='font-awesome/css/font-awesome.min.css') }}">
	    
		<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/style.css') }}">
	</head>
	<body>
		<div id="wifiContainer">
			<div class="user-form">
				<form action="/generate_204" method="POST" id="wifi-form">

					<div class="form-group ">
						<div class="input-group" id="ssid" > 
							<span class="input-group-addon"><i class="fa fa-wifi"></i></span>
							<select class='form-control'  name="ssid" required>
								<option value="" selected="selected">Selectioner votre Wifi</option>
								{% for connexion in connexions %}
								<option value="{{connexion.ssid}}" data-security="{{connexion.security}}" >{{connexion.ssid}}</option>
								{%endfor%}
							</select>
						</div>
						<div class='hidden input-group' id="hide-ssid">
						<span class='hidden input-group-addon'><i class='fa fa-wifi'></i></span>
						<input class='form-control' name='hide-ssid' class='form-control' placeholder='Entrer le nom de l&rsquo;ssid' required='required'>\
						</div>

						<div class="hidden input-group" id="hide-security">
							<span class="hidden input-group-addon"><i class="fa fa-lock"></i></span>
							<select class='form-control' id="ssid" name="hide-sec" required>
								<option value="" >Choisisser le protocole de sécurité</option>

								<option value="WPA">WEP/WPA/WPA2</option>

								<option value="ENTERPRISE">Entreprise</option>

								<option value="NONE">Ouvert</option>
							</select>
						</div>
					</div>

				<div class="form-group" id='auth-method'>
					<div class='hidden input-group' id="usr">
						<span class='hidden input-group-addon'><i class='fa fa-user'></i></span>
						<input class='form-control' name='user' placeholder='Nom d&rsquo;utilisateur' required='required'>\
					</div>
					<div class='hidden input-group' id="pass">
						<span class='hidden input-group-addon'><i class='fa fa-key'></i></span>
						<input class='form-control' type='password' name='password' placeholder='*********' required='required'>\
					</div>

				</div>
				<input type='hidden' id='security' name='security' value='NONE'>


				<div class="form-group">
					<button type="submit" class="btn btn-success btn-block">
						Connecter
					</button>
				</div>
				<div class="clearfix">
					<a id="hide-wifi" class="pull-right text-success light-green-color">Se connecter sur un wifi invisible</a>
				</div>

				</form>
			</div>
			
		</div>



		<!-- jQuery and Bootstrap JS -->
		<script src="{{ url_for('static', filename='js/jquery-3.5.1.min.js') }}"></script>
    <script src="{{ url_for('static', filename='bootstrap/js/bootstrap.min.js') }}"></script>
		<script>

		function hide_not_required(item){
			item.addClass('hidden');
			item.children(".form-control").attr("required", false);
		}

		function show_required(item){
			item.removeClass('hidden');
			item.children(".form-control").attr("required", "required");

		}

		function toggle_required(item){
			item.toggleClass('hidden')
			item.children(".form-control").attr("required", !item.hasClass('hidden')); 
		}

		function change_security_view(security){
			$('input#security').val(security)
			if (security === 'WPA2' || security === 'WPA' || security === 'WEP' ){
				hide_not_required($("#usr"));
				show_required($("#pass"));
			}
			else if(security === 'NONE'){
				hide_not_required($("#usr"));
				hide_not_required($("#pass"));

			}
			else if(security === 'ENTERPRISE'){
				show_required($("#usr"));
				show_required($("#pass"));
			}
		}
			hide_not_required($("#usr"));
			hide_not_required($("#pass"));
			hide_not_required($("#hide-ssid"));
			hide_not_required($("#hide-security"));

		$( document ).ready(function() {




			$("#ssid select").change(function(){
				console.log($(this).children(":selected").text())
				var security = $(this).find(':selected').attr('data-security')
				change_security_view(security)
			});

			$("#hide-wifi").click(function(){
				hide_not_required($("#usr"));
				hide_not_required($("#pass"));
				toggle_required($("#ssid"));
				toggle_required($("#hide-ssid"));
				toggle_required($("#hide-security"));

			});

			$("#hide-security").change(function(){
				console.log($("#hide-security option:selected").val());
				change_security_view($("#hide-security option:selected").val());
				
			})

			$('#wifi-form').submit(function(ev){
				$(".hidden").empty()
			})

		});
	</script>

	</body>
</html>